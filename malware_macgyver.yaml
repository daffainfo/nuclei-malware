id: malware_macgyver

info:
  name: MacGyver.cap Malware Detector
  author: daffainfo
  severity: critical
  reference: https://github.com/fboldewin/MacGyver-s-return---An-EMV-Chip-cloning-case/blob/master/MacGyver's%20return%20-%20An%20EMV%20Chip%20cloning%20case.pdf
  metadata:
    author_original: "xylitol@temari.fr"
    date: "2021-05-11"
    hash1: "9dc70002e82c78ee34c813597925c6cf8aa8d68b7e9ce5bcc70ea9bcab9dbf4a"
  tags: malware,file

file:
  - extensions:
      - all

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "src/MacGyver/javacard/Header.cap"
          - "src/MacGyver/javacard/Directory.cap"
          - "src/MacGyver/javacard/Applet.cap"
          - "src/MacGyver/javacard/Import.cap"
          - "src/MacGyver/javacard/ConstantPool.cap"
          - "src/MacGyver/javacard/Class.cap"
          - "src/MacGyver/javacard/Method.cap"
        condition: and